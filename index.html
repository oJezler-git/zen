<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Zen*</title>
    <link rel="preload" href="img/light.png" as="image" />
    <link rel="preload" href="img/dark.png" as="image" />
    <link rel="icon" href="favicon.ico" type="image/png" />
    <link rel="apple-touch-icon" href="favicon.ico" />
    <link rel="stylesheet" href="styles/styles.css" />
    <noscript>
      <div
        style="
          padding: 20px;
          text-align: center;
          background-color: #f8d7da;
          color: #721c24;
          border: 1px solid #f5c6cb;
          border-radius: 4px;
          margin: 10px;
        "
      >
        This website requires JavaScript to function properly. Please enable
        JavaScript in your browser settings.
      </div>
    </noscript>
  </head>
  <body data-theme="light">
    <div class="container">
      <div class="header">
        <div class="logo" id="zen-logo">Zen*</div>
        <div class="theme-toggle" id="theme-toggle">
          <div class="theme-toggle-inner">
            <div class="theme-toggle-circle" id="toggle-circle">☀️</div>
          </div>
        </div>
      </div>

      <div class="hero-section">
        <h1 class="greeting" id="greeting">Begin with Purpose</h1>
        <p class="greeting-subtitle" id="greeting-subtitle">
          We’re guests on Earth—make your stay unforgettable.
        </p>
        <div class="date-time" id="datetime"></div>
      </div>

      <div class="quote-section">
        <div class="quote" id="quote">""</div>
        <div class="quote-author" id="quote-author"></div>
      </div>

      <div class="main-grid">
        <div class="card">
          <h2 class="card-title">
            <svg class="icon" viewBox="0 0 24 24">
              <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" />
            </svg>
            Today's Intentions
          </h2>
          <div id="todo-list">
            <div class="todo-item">
              <input type="checkbox" class="todo-checkbox" />
              <span class="todo-text">Review project roadmap</span>
            </div>
            <div class="todo-item">
              <input type="checkbox" class="todo-checkbox" />
              <span class="todo-text">Morning reflection practice</span>
            </div>
            <div class="todo-item">
              <input type="checkbox" class="todo-checkbox" />
              <span class="todo-text">Plan tomorrow's priorities</span>
            </div>
          </div>
          <input
            type="text"
            class="todo-input"
            placeholder="What will you accomplish today?"
            id="todo-input"
          />
        </div>

        <div class="card">
          <h2 class="card-title">
            <svg class="icon" viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="10" />
              <path d="M9 18l6-6-6-6" />
            </svg>
            Focus Music
          </h2>
          <iframe
            src="https://music.ojezler.com/players/focus.html"
            style="width: 100%; height: 300px; border: none; border-radius: 8px"
            title="Focus Music Player"
          ></iframe>
        </div>

        <div class="card">
          <h2 class="card-title">
            <svg class="icon" viewBox="0 0 24 24">
              <rect
                width="18"
                height="18"
                x="3"
                y="3"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                rx="2"
              />
              <path d="M12 8v4l3 3" />
            </svg>
            Quick Access
          </h2>
          <div class="quick-links">
            <a href="https://gmail.com" class="quick-link" target="_blank">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M20 6L9 13l-5-3.5V7l5 3.5L20 4v2z" />
                <rect
                  width="18"
                  height="14"
                  x="3"
                  y="4"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  rx="2"
                />
              </svg>
              Mail
            </a>
            <a
              href="https://calendar.google.com"
              class="quick-link"
              target="_blank"
            >
              <svg class="icon" viewBox="0 0 24 24">
                <rect
                  width="18"
                  height="18"
                  x="3"
                  y="4"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  rx="2"
                />
                <line x1="16" y1="2" x2="16" y2="6" />
                <line x1="8" y1="2" x2="8" y2="6" />
              </svg>
              Calendar
            </a>
            <a href="https://github.com" class="quick-link" target="_blank">
              <svg class="icon" viewBox="0 0 24 24">
                <path
                  d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"
                />
              </svg>
              Code
            </a>
            <a href="https://notion.so" class="quick-link" target="_blank">
              <svg class="icon" viewBox="0 0 24 24">
                <rect
                  width="18"
                  height="18"
                  x="3"
                  y="3"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  rx="2"
                />
                <line x1="9" y1="9" x2="15" y2="9" />
                <line x1="9" y1="13" x2="15" y2="13" />
              </svg>
              Notes
            </a>
          </div>
        </div>
      </div>

      <div class="stats-section">
        <div class="card">
          <h2 class="card-title">
            <svg class="icon" viewBox="0 0 24 24">
              <path
                d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"
              />
            </svg>
            Today's Journey
          </h2>
          <p class="progress-text">
            Your momentum is building. Each completed intention moves you
            forward.
          </p>
          <div
            style="
              display: flex;
              justify-content: space-between;
              margin-bottom: 10px;
            "
          >
            <span>Intentions Achieved</span>
            <span id="task-progress">0/3</span>
          </div>
          <div class="progress-bar-container">
            <div class="progress-bar-fill" id="progress-bar-fill"></div>
          </div>
        </div>

        <div class="card">
          <h2 class="card-title">
            <svg class="icon" viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="10" />
              <path d="M8 14s1.5 2 4 2 4-2 4-2" />
              <line x1="9" y1="9" x2="9.01" y2="9" />
              <line x1="15" y1="9" x2="15.01" y2="9" />
            </svg>
            Focus Mastery
          </h2>
          <div class="focus-stats">
            <div class="focus-time" id="focus-time">0h 0m</div>
            <div class="focus-subtitle">Deep work achieved</div>
            <div class="sessions-text">
              <span id="sessions-count">0</span> focused sessions completed
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Enhanced debug controls with quote rotation testing
      function Debug() {
        // Prevent multiple panels
        if (document.getElementById("debug-time-panel")) return;

        // Initialize debugDate first
        let debugDate = new Date();
        const originalDate = Date;

        // Define helper functions that use debugDate
        function getCurrentTimePeriod() {
          const hour = debugDate.getHours();
          if (hour >= 0 && hour < 4) return "Night";
          if (hour < 12) return "Morning";
          if (hour < 20) return "Midday";
          return "Evening";
        }

        function updateDebugInfo() {
          const currentQuote = localStorage.getItem("currentQuote");
          document.getElementById("debug-period").textContent =
            getCurrentTimePeriod();
          document.getElementById(
            "debug-hour"
          ).textContent = `${debugDate.getHours()}:00`;
          document.getElementById("debug-quote").textContent = currentQuote
            ? JSON.parse(currentQuote).text.substring(0, 30) +
              (JSON.parse(currentQuote).text.length > 30 ? "..." : "")
            : "None";
        }

        function applyDebugTime(hour) {
          debugDate = new Date();
          debugDate.setHours(hour, 0, 0, 0);

          window.Date = class extends originalDate {
            constructor() {
              super();
              return debugDate;
            }
          };

          // Update all time-dependent components
          updateDateTime?.();
          setThemeBasedOnTime?.();
          setRandomQuote?.();
          updateGreeting?.();
          updateMotivationalMessage?.();
          updateDebugInfo();

          console.log(`Time set to: ${hour}:00 (${getCurrentTimePeriod()})`);
        }

        // Now create the panel HTML
        const debugDiv = document.createElement("div");
        debugDiv.id = "debug-time-panel";
        debugDiv.style.cssText = `
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--bg-card);
      padding: 15px;
      border-radius: 10px;
      border: 1px solid var(--border-color);
      z-index: 1000;
      max-width: 300px;
      font-family: monospace;
      box-shadow: 0 0 20px rgba(0,0,0,0.3);
    `;

        debugDiv.innerHTML = `
      <div style="margin-bottom: 10px; font-weight: bold; color: var(--text-primary); border-bottom: 1px solid var(--border-color); padding-bottom: 8px;">
        🛠️ Debug Controls
      </div>
      
      <div style="margin-bottom: 12px;">
        <div style="margin-bottom: 6px; font-size: 14px; color: var(--text-primary);">Simulate Time:</div>
        <select id="debug-time" style="width: 100%; padding: 6px; margin-bottom: 8px; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border-color); border-radius: 4px;">
          <option value="0">🌙 0:00 AM (Night)</option>
          <option value="3">🌌 3:00 AM (Night)</option>
          <option value="6">🌅 6:00 AM (Morning)</option>
          <option value="10">☀️ 10:00 AM (Morning)</option>
          <option value="14">🏙️ 2:00 PM (Midday)</option>
          <option value="17">🌇 5:00 PM (Midday)</option>
          <option value="21">🌃 9:00 PM (Evening)</option>
        </select>
        <div style="display: flex; gap: 8px;">
          <button id="apply-debug-time" style="padding: 6px 10px; flex: 1; background: var(--accent-color); color: white; border: none; border-radius: 4px;">
            Apply Time
          </button>
          <button id="cycle-time-periods" style="padding: 6px 10px; flex: 1; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border-color); border-radius: 4px;">
            Cycle Period
          </button>
        </div>
      </div>
      
      <div style="margin-bottom: 12px;">
        <div style="margin-bottom: 6px; font-size: 14px; color: var(--text-primary);">Quote Testing:</div>
        <div style="display: flex; gap: 8px; margin-bottom: 8px;">
          <button id="test-quote-rotation" style="padding: 6px 10px; flex: 1; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border-color); border-radius: 4px;">
            Next Quote
          </button>
          <button id="reset-quote-storage" style="padding: 6px 10px; flex: 1; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border-color); border-radius: 4px;">
            Reset History
          </button>
        </div>
        <button id="view-storage" style="padding: 6px 10px; width: 100%; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border-color); border-radius: 4px;">
          View Storage
        </button>
      </div>
      
      <div style="margin-bottom: 12px; padding: 10px; background: var(--bg-primary); border-radius: 4px; border: 1px solid var(--border-color);">
        <div style="font-size: 12px; color: var(--text-secondary); line-height: 1.5;">
          <div><strong>Current Period:</strong> <span id="debug-period">${getCurrentTimePeriod()}</span></div>
          <div><strong>Current Hour:</strong> <span id="debug-hour">${debugDate.getHours()}:00</span></div>
          <div><strong>Last Quote:</strong> <span id="debug-quote" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: block;">${
            localStorage.getItem("currentQuote")
              ? JSON.parse(localStorage.getItem("currentQuote")).text.substring(
                  0,
                  20
                ) + "..."
              : "None"
          }</span></div>
        </div>
      </div>
      
      <div>
        <button id="close-debug" style="padding: 6px 10px; width: 100%; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border-color); border-radius: 4px;">
          Close Panel
        </button>
      </div>
    `;

        document.body.appendChild(debugDiv);

        // Set up event listeners
        document
          .getElementById("apply-debug-time")
          .addEventListener("click", () => {
            const selectedHour = parseInt(
              document.getElementById("debug-time").value
            );
            applyDebugTime(selectedHour);
          });

        document
          .getElementById("cycle-time-periods")
          .addEventListener("click", () => {
            const currentHour = debugDate.getHours();
            let nextHour;
            if (currentHour < 6) nextHour = 6; // night → morning
            else if (currentHour < 12) nextHour = 12; // morning → midday
            else if (currentHour < 20) nextHour = 20; // midday → evening
            else nextHour = 0; // evening → night

            document.getElementById("debug-time").value = nextHour;
            applyDebugTime(nextHour);
          });

        document
          .getElementById("test-quote-rotation")
          .addEventListener("click", () => {
            setRandomQuote?.();
            updateDebugInfo();
            console.log("Displayed new quote");
          });

        document
          .getElementById("view-storage")
          .addEventListener("click", () => {
            const storage =
              JSON.parse(localStorage.getItem("displayedQuotes")) || {};
            console.group("Quote Storage");
            console.log("Current time period:", getCurrentTimePeriod());
            console.log("All stored data:", storage);

            for (const period of ["Morning", "Midday", "Evening", "Night"]) {
              const periodData = storage[period.toLowerCase()] || {
                recent: [],
                cycleCount: {},
              };
              console.log(
                `${period}: ${periodData.recent.length} recent quotes`
              );
            }

            console.groupEnd();
          });

        document
          .getElementById("reset-quote-storage")
          .addEventListener("click", () => {
            localStorage.removeItem("displayedQuotes");
            localStorage.removeItem("currentQuote");
            localStorage.removeItem("lastQuoteTime");
            localStorage.removeItem("lastQuoteHour");
            console.log("Quote history reset");
            updateDebugInfo();
            alert("Quote history has been reset");
          });

        document.getElementById("close-debug").addEventListener("click", () => {
          debugDiv.remove();
          window.Date = originalDate;
          console.log("Debug panel closed - time simulation disabled");
        });

        updateDebugInfo();
      }

      if (
        window.location.hostname === "localhost" ||
        window.location.hostname === "127.0.0.1"
      ) {
        document.addEventListener("DOMContentLoaded", Debug);
      }

      window.enableDebugControls = () => {
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", Debug);
        } else {
          Debug();
        }
        console.log("✅ Debug controls enabled");
      };
    </script>
    <script src="scripts/script.js"></script>
  </body>
</html>
